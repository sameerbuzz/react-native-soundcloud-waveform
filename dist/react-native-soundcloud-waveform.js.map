{"version":3,"file":"react-native-soundcloud-waveform.js","sources":["../src/utils/index.js","../src/components/Waveform.js","../src/index.js"],"sourcesContent":["/* eslint import/no-unresolved: [2, { ignore: ['react-native'] }] */\nimport { Dimensions } from 'react-native';\n\nfunction getColor(\n  bars,\n  bar,\n  percentPlayed,\n  percentPlayable,\n  inverse,\n  ACTIVE,\n  ACTIVE_INVERSE,\n  ACTIVE_PLAYABLE,\n  ACTIVE_PLAYABLE_INVERSE,\n  INACTIVE,\n  INACTIVE_INVERSE,\n) {\n  if (bar / bars.length < percentPlayed) {\n    return inverse ? ACTIVE_INVERSE : ACTIVE;\n  } if (bar / bars.length < percentPlayable) {\n    return inverse ? ACTIVE_PLAYABLE_INVERSE : ACTIVE_PLAYABLE;\n  }\n  return inverse ? INACTIVE_INVERSE : INACTIVE;\n}\n\nconst dimensionsWidth = Dimensions.get('window').width;\n\nexport { getColor, dimensionsWidth };\n","/* eslint import/no-unresolved: [2, { ignore: ['react', 'react-native'] }] */\n/* eslint-disable react/no-array-index-key */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { View, TouchableOpacity } from 'react-native';\n\nimport { scaleLinear } from 'd3-scale';\nimport { mean } from 'd3-array';\nimport _ from 'lodash';\n\nimport { getColor } from '../utils';\n\nfunction Waveform(\n  {\n    waveform,\n    height,\n    width,\n    setTime,\n    percentPlayed,\n    percentPlayable,\n    inverse,\n    active,\n    activeInverse,\n    activePlayable,\n    activePlayableInverse,\n    inactive,\n    inactiveInverse,\n  },\n) {\n  const scaleLinearHeight = scaleLinear().domain([0, waveform.height]).range([0, height]);\n  const chunks = _.chunk(waveform.samples, waveform.width / ((width - 60) / 3));\n  return (\n    <View style={[{\n      height,\n      width,\n      justifyContent: 'center',\n      flexDirection: 'row',\n    },\n    inverse && {\n      transform: [\n        { rotateX: '180deg' },\n        { rotateY: '0deg' },\n      ],\n    },\n    ]}\n    >\n      {chunks.map((chunk, i) => (\n        <TouchableOpacity\n          key={i}\n          onPress={() => {\n            setTime(i);\n          }}\n        >\n          <View style={{\n            backgroundColor: getColor(\n              chunks,\n              i,\n              percentPlayed,\n              percentPlayable,\n              inverse,\n              active,\n              activeInverse,\n              activePlayable,\n              activePlayableInverse,\n              inactive,\n              inactiveInverse,\n            ),\n            width: 2,\n            marginRight: 1,\n            height: scaleLinearHeight(mean(chunk)),\n          }}\n          />\n        </TouchableOpacity>\n      ))}\n    </View>\n  );\n}\n\nWaveform.propTypes = {\n  waveform: PropTypes.object.isRequired,\n  height: PropTypes.number.isRequired,\n  width: PropTypes.number.isRequired,\n  setTime: PropTypes.func.isRequired,\n  percentPlayed: PropTypes.number.isRequired,\n  percentPlayable: PropTypes.number.isRequired,\n  inverse: PropTypes.bool.isRequired,\n  active: PropTypes.string.isRequired,\n  activeInverse: PropTypes.string.isRequired,\n  activePlayable: PropTypes.string.isRequired,\n  activePlayableInverse: PropTypes.string.isRequired,\n  inactive: PropTypes.string.isRequired,\n  inactiveInverse: PropTypes.string.isRequired,\n};\n\nexport default Waveform;\n","/* eslint import/no-unresolved: [2, { ignore: ['react', 'react-native'] }] */\n/* eslint-disable no-undef */\nimport React, { Component } from 'react';\nimport { View } from 'react-native';\nimport PropTypes from 'prop-types';\n\nimport Waveform from './components/Waveform';\n\nimport { dimensionsWidth } from './utils';\n\nclass SoundCloudWave extends Component {\n  state = {\n    waveform: null,\n  }\n\n  componentDidMount() {\n    const { waveformUrl } = this.props;\n    fetch(waveformUrl.replace('png', 'json'))\n      .then(res => res.json())\n      .then((json) => {\n        this.setState({\n          waveform: json,\n        });\n      });\n  }\n\n  render() {\n    const {\n      height,\n      width,\n      percentPlayed,\n      percentPlayable,\n      setTime,\n      active,\n      activeInverse,\n      activePlayable,\n      activePlayableInverse,\n      inactive,\n      inactiveInverse,\n    } = this.props;\n    const { waveform } = this.state;\n    if (!waveform) return null;\n    return (\n      <View style={{ flex: 1, justifyContent: 'center' }}>\n        <Waveform\n          waveform={waveform}\n          height={height}\n          width={width}\n          setTime={setTime}\n          percentPlayed={percentPlayed}\n          percentPlayable={percentPlayable}\n          active={active}\n          activeInverse={activeInverse}\n          activePlayable={activePlayable}\n          activePlayableInverse={activePlayableInverse}\n          inactive={inactive}\n          inactiveInverse={inactiveInverse}\n          inverse\n        />\n        <Waveform\n          waveform={waveform}\n          height={height}\n          width={width}\n          setTime={setTime}\n          percentPlayed={percentPlayed}\n          percentPlayable={percentPlayable}\n          active={active}\n          activeInverse={activeInverse}\n          activePlayable={activePlayable}\n          activePlayableInverse={activePlayableInverse}\n          inactive={inactive}\n          inactiveInverse={inactiveInverse}\n          inverse={false}\n        />\n      </View>\n    );\n  }\n}\n\nSoundCloudWave.defaultProps = {\n  percentPlayable: 0,\n  height: 50,\n  width: dimensionsWidth,\n  active: '#FF1844',\n  activeInverse: '#4F1224',\n  activePlayable: '#1b1b26',\n  activePlayableInverse: '#131116',\n  inactive: '#424056',\n  inactiveInverse: '#1C1A27',\n};\n\nSoundCloudWave.propTypes = {\n  waveformUrl: PropTypes.string.isRequired,\n  setTime: PropTypes.func.isRequired,\n  percentPlayed: PropTypes.number.isRequired,\n  percentPlayable: PropTypes.number,\n  height: PropTypes.number,\n  width: PropTypes.number,\n  active: PropTypes.string,\n  activeInverse: PropTypes.string,\n  activePlayable: PropTypes.string,\n  activePlayableInverse: PropTypes.string,\n  inactive: PropTypes.string,\n  inactiveInverse: PropTypes.string,\n};\n\nexport default SoundCloudWave;\n"],"names":["getColor","bars","bar","percentPlayed","percentPlayable","inverse","ACTIVE","ACTIVE_INVERSE","ACTIVE_PLAYABLE","ACTIVE_PLAYABLE_INVERSE","INACTIVE","INACTIVE_INVERSE","length","dimensionsWidth","Dimensions","get","width","Waveform","waveform","height","setTime","active","activeInverse","activePlayable","activePlayableInverse","inactive","inactiveInverse","scaleLinearHeight","scaleLinear","domain","range","chunks","_","chunk","samples","React","View","justifyContent","flexDirection","transform","rotateX","rotateY","map","i","TouchableOpacity","backgroundColor","marginRight","mean","propTypes","PropTypes","object","isRequired","number","func","bool","string","SoundCloudWave","componentDidMount","waveformUrl","props","fetch","replace","then","res","json","setState","render","state","flex","Component","defaultProps"],"mappings":"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"}